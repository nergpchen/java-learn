什么是等待/通知机制介绍

等待/通知机制，是指一个线程A调用了对象O的wait\(\)方法进入等待状态

，而另一个线程B调用了对象O的notify\(\)/notifyAll\(\)方法，线程A收到通知后退出

等待队列，进入可运行状态，进而执行后续操作。

上诉两个线程通过对象O来完成交互，而对象上的**wait\(\)方法**和**notify\(\)/notifyAll\(\)方法**的关系就如同开关信号一样，用来完成等待方和通知方之间的交互工作。

### 1.3 等待/通知机制的相关方法 {#13-等待通知机制的相关方法}

| 方法名称 | 描述 |
| :--- | :--- |
| notify\(\) | 随机唤醒等待队列中等待同一共享资源的**“一个线程”**，并使该线程退出等待队列，进入可运行状态，也就是**notify\(\)方法仅通知“一个线程”** |
| notifyAll\(\) | 使所有正在等待队列中等待同一共享资源的**“全部线程”**退出等待队列，进入可运行状态。此时，优先级最高的那个线程最先执行，但也有可能是随机执行，这取决于JVM虚拟机的实现 |
| wait\(\) | 使调用该方法的线程释放共享资源锁，然后从运行状态退出，进入等待队列，直到被再次唤醒 |
| wait\(long\) | 超时等待一段时间，这里的参数时间是毫秒，也就是等待长达n毫秒，如果没有通知就超时返回 |
| wait\(long，int\) | 对于超时时间更细力度的控制，可以达到纳秒 |



### 2.3 notify\(\)锁不释放 {#23-notify锁不释放}

**当方法wait\(\)被执行后，锁自动被释放，但执行完notify\(\)方法后，锁不会自动释放。必须执行完notify\(\)方法所在的synchronized代码块后才释放。**



2.4 当interrupt方法遇到wait方法

当线程呈wait状态时，对线程对象调用interrupt方法会出现InterrupedException异常。

